<%# Header %>
<%= render "shared/page_header",
    title: "Game Sessions",
    context: @table.name,
    description: "Track and review your poker sessions" %>

<%# Sessions list %>
<div class="space-y-4">
  <% if @game_sessions.any? %>
    <% @game_sessions.each do |session| %>
      <%= render "shared/info_card",
          icon: "clock-play",
          title: session.game_format.name,
          description: session.created_at.strftime("%b %d, %Y") do %>
        
        <%# Player results %>
        <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3 mt-4">
          <% session.player_results.each do |result| %>
            <div class="flex items-center space-x-2 text-sm">
              <span class="text-lg"><%= result.player.emoji %></span>
              <span class="text-primary-400 font-mono truncate"><%= result.player.name %></span>
              <span class="text-primary-50 font-mono"><%= result.total_amount %></span>
            </div>
          <% end %>
        </div>

        <% if session.remarks.present? %>
          <p class="mt-3 text-sm text-primary-400 font-mono">
            <%= tabler_icon('message-circle', size: 16, class: 'inline-block mr-1') %>
            <%= session.remarks %>
          </p>
        <% end %>
      <% end %>
    <% end %>

    <%= render 'shared/create_button',
        path: select_format_table_game_sessions_path(@table),
        text: 'Record new session' %>
  <% else %>
    <% has_players = @table.players.exists? %>
    <% has_formats = @table.game_formats.exists? %>

    <% if !has_players || !has_formats %>
      <%= render "shared/info_card",
          icon: "list-check",
          title: "Complete Setup Checklist",
          description: "Before recording your first session, please complete the following setup steps:",
          class_name: "mb-4" do %>
        
        <div class="space-y-3 mt-4">
          <% if !has_players %>
            <%= render "shared/empty_state",
                icon: "users",
                title: "Add Players",
                description: "Add the players who will participate in your poker games.",
                path: new_table_player_path(@table),
                compact: true %>
          <% end %>

          <% if !has_formats %>
            <%= render "shared/empty_state",
                icon: "cards",
                title: "Create Game Format",
                description: "Set up your game format with buy-in amount and chip denominations.",
                path: new_table_game_format_path(@table),
                compact: true %>
          <% end %>
        </div>
      <% end %>
    <% else %>
      <%# Ready to create sessions %>
      <%= render "shared/empty_state",
          icon: "clock-play",
          title: "Ready to Record Sessions",
          description: "You've completed the setup! Start tracking your poker sessions to analyze player performance.",
          path: select_format_table_game_sessions_path(@table),
          compact: true %>
    <% end %>
  <% end %>
</div>

<%= render 'shared/bottom_nav' %> 